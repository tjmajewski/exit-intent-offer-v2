{% comment %}
  Exit Intent Modal - Loads settings and initializes the modal
{% endcomment %}

<script>
  // Pass settings from Shopify to JavaScript
  window.exitIntentSettings = {
    enabled: {{ shop.metafields.exit_intent.status.value.enabled | default: false | json }},
    mode: {{ shop.metafields.exit_intent.settings.value.mode | default: "manual" | json }},
    plan: {{ shop.metafields.exit_intent.settings.value.plan | default: "pro" | json }},
    modalHeadline: {{ shop.metafields.exit_intent.settings.value.modalHeadline | default: "Wait! Don't leave yet üéÅ" | json }},
    modalBody: {{ shop.metafields.exit_intent.settings.value.modalBody | default: "Complete your purchase now and get free shipping on your order!" | json }},
    ctaButton: {{ shop.metafields.exit_intent.settings.value.ctaButton | default: "Complete My Order" | json }},
    discountCode: {{ shop.metafields.exit_intent.settings.value.discountCode | default: null | json }},
    offerType: {{ shop.metafields.exit_intent.settings.value.offerType | default: "percentage" | json }},
    redirectDestination: {{ shop.metafields.exit_intent.settings.value.redirectDestination | default: "checkout" | json }},
    triggers: {
      exitIntent: {{ shop.metafields.exit_intent.settings.value.exitIntentEnabled | default: true | json }},
      timeDelay: {{ shop.metafields.exit_intent.settings.value.timeDelayEnabled | default: false | json }},
      timeDelaySeconds: {{ shop.metafields.exit_intent.settings.value.timeDelaySeconds | default: 30 | json }},
      cartValue: {{ shop.metafields.exit_intent.settings.value.cartValueEnabled | default: false | json }},
      minCartValue: {{ shop.metafields.exit_intent.settings.value.cartValueMin | default: 0 | json }},
      maxCartValue: {{ shop.metafields.exit_intent.settings.value.cartValueMax | default: 999999 | json }}
    },
    brandPrimaryColor: {{ shop.metafields.exit_intent.settings.value.brandPrimaryColor | default: "#000000" | json }},
    brandSecondaryColor: {{ shop.metafields.exit_intent.settings.value.brandSecondaryColor | default: "#ffffff" | json }},
    brandAccentColor: {{ shop.metafields.exit_intent.settings.value.brandAccentColor | default: "#f59e0b" | json }},
    brandFont: {{ shop.metafields.exit_intent.settings.value.brandFont | default: "system" | json }}
  };
</script>

<script src="{{ 'exit-intent-modal.js' | asset_url }}" defer></script>
<script src="{{ 'cart-monitor.js' | asset_url }}" defer></script>